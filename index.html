<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Petar's Smart Glove</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; text-align: center; padding: 50px; background-color: #1a1a1a; color: white; }
        .container { background: #2c2c2c; padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); display: inline-block; }
        #povezi { padding: 15px 40px; font-size: 18px; cursor: pointer; background: #28a745; color: white; border: none; border-radius: 50px; transition: 0.3s; text-transform: uppercase; font-weight: bold; }
        #povezi:hover { background: #218838; transform: scale(1.05); }
        #status { margin-top: 25px; font-size: 1.2em; color: #bbb; }
        .pulse { animation: pulse-animation 2s infinite; }
        @keyframes pulse-animation { 0% { box-shadow: 0 0 0 0px rgba(40, 167, 69, 0.4); } 100% { box-shadow: 0 0 0 20px rgba(40, 167, 69, 0); } }
    </style>
</head>
<body>

    <div class="container">
        <h1>Smart Glove Project</h1>
        <p>Future of Communication by Petar</p>
        
        <button id="povezi">Connect Glove</button>
        <div id="status">Status: Disconnected</div>
    </div>

    <script>
        const SERVICE_UUID = '6e400001-b5a3-f393-e0a9-e50e24dcca9e';
        const TX_CHARACTERISTIC_UUID = '6e400003-b5a3-f393-e0a9-e50e24dcca9e';

        const dugme = document.getElementById('povezi');
        const statusPolje = document.getElementById('status');

        dugme.addEventListener('click', async () => {
            try {
                statusPolje.innerText = "Scanning for glove...";
                const device = await navigator.bluetooth.requestDevice({
                    acceptAllDevices: true,
                    optionalServices: [SERVICE_UUID]
                });

                statusPolje.innerText = "Connecting...";
                const server = await device.gatt.connect();
                const service = await server.getPrimaryService(SERVICE_UUID);
                const characteristic = await service.getCharacteristic(TX_CHARACTERISTIC_UUID);

                await characteristic.startNotifications();
                
                statusPolje.innerText = "Status: CONNECTED ✅";
                statusPolje.style.color = "#28a745";
                dugme.classList.add('pulse');

                characteristic.addEventListener('characteristicvaluechanged', (event) => {
                    let decoder = new TextDecoder('utf-8');
                    let msg = decoder.decode(event.target.value).trim();
                    
                    console.log("Received:", msg);

                    if (!window.speechSynthesis.speaking) {
                        // Logika usklađena sa tvojim novim main.cpp
                        if (msg === "No") speak("No");
                        else if (msg === "Yes") speak("Yes");
                        else if (msg === "How") speak("How are you?");
                        else if (msg === "Hello") speak("Hello");
                        else if (msg === "Serbia") speak("Serbia");
                        else if (msg === "Help") speak("Help");
                        else if (msg === "Goodbye") speak("Goodbye");
                    }
                });

            } catch (error) {
                statusPolje.innerText = "Error: " + error.message;
            }
        });

        function speak(text) {
            const synth = window.speechSynthesis;
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'en-US';
            utterance.rate = 0.9;
            synth.speak(utterance);
        }
    </script>
</body>
</html>
